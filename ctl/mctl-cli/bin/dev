#!/usr/bin/env node

require(`@yarnpkg/pnpify`).patchFs()

require(`@babel/register`)({
   root: require('path').dirname(__dirname),
   extensions: [`.tsx`, `.ts`],
   only: [
     // TODO: read from package.json workspaces
     p => p.includes('code/') || p.includes('ctl/') || p.includes('prettier/'),
   ],
   plugins: [
    `@babel/plugin-transform-modules-commonjs`,
    `@babel/plugin-proposal-optional-chaining`,
    `@babel/plugin-proposal-nullish-coalescing-operator`,
    [`@babel/plugin-proposal-decorators`, { legacy: true }],
    [`@babel/plugin-proposal-class-properties`, { loose: true }],
    `@babel/plugin-proposal-async-generator-functions`,
  ],
   presets: [
    `@babel/preset-typescript`,
  ],
 })

require('../src/cli').run()

